FROM python:3.10


ARG PROJECT_PACKAGE_NAME=data_processor

ARG WORK_DIR=/code
ARG REQUIREMENTS_FILENAME=requirements.txt


ENV WAIT_SERVICE_FILENAME=wait-service.sh
ENV BROKER_HOST=broker
ENV BROKER_PORT=9092


WORKDIR ${WORK_DIR}



COPY ${REQUIREMENTS_FILENAME} .
RUN pip install -r ${REQUIREMENTS_FILENAME}


COPY ${PROJECT_PACKAGE_NAME} .



CMD ./${WAIT_SERVICE_FILENAME} ${BROKER_HOST} ${BROKER_PORT} && python main.py
